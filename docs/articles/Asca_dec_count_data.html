<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ASCA Decomposition of Synthetic Count Data • gASCA</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="ASCA Decomposition of Synthetic Count Data">
<meta property="og:description" content="gASCA">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">gASCA</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Asca_dec_count_data.html">ASCA Decomposition of Synthetic Count Data</a>
    </li>
    <li>
      <a href="../articles/Asca_dec_count_data_tidy.html">Plotting gASCA results with ggplot and tidyverse</a>
    </li>
    <li>
      <a href="../articles/BBS_data_preparation.html">BBS data preparation</a>
    </li>
    <li>
      <a href="../articles/BBS_gASCA_analysis.html">gASCA analysis of the BBS dataset</a>
    </li>
    <li>
      <a href="../articles/synthetic_dataset.html">Synthetic_Dataset</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>ASCA Decomposition of Synthetic Count Data</h1>
                        <h4 data-toc-skip class="author">Pietro
Franceschi</h4>
            
      
      
      <div class="hidden name"><code>Asca_dec_count_data.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>To illustrate the use of gASCA in the analysis of count data we will
consider a synthetic dataset which is available as a part of the package
installation. This vignette will be also used to show how to use
gg-style plotting to visualize the results of the gASCA analyses</p>
</div>
<div class="section level2">
<h2 id="the-dataset">The dataset<a class="anchor" aria-label="anchor" href="#the-dataset"></a>
</h2>
<p>The synthetic dataset was simulated to mimic the results of a
hypothetical experiment where the abundance of 15 species is measured
over time across different treatments, with the following design:</p>
<ul>
<li>15 count variables (e.g. species, identified as
<code>s1 .. s15</code>)</li>
<li>2 factor design (5 time points, 3 treatments)</li>
<li>10 replicates</li>
</ul>
<p>The example dataset was designed to have two latent variables (LV)
for the time factor and one for the treatment.</p>
<p>Considering the 15 variables:</p>
<ul>
<li>The first four are responsive to the time factor. <code>s1</code>
and <code>s2</code> mirrors LV1, <code>s3</code> and <code>s4</code> are
linked to LV2.</li>
<li>
<code>s5</code> and <code>s6</code> are affected by the treatment
factor.</li>
<li>
<code>s7</code> and <code>s10</code> are also sensitive to the two
LVs of the interaction. In other words, for them the effect of treatment
depends on time.</li>
<li>The remaining variables contain only noise.</li>
</ul>
<p>The dataset is included in the package as a two element list
containing the count matrix <code>synth_count_data$counts</code> and a
data frame holding the association between the 150 samples and the
design factors (<code>synth_count_data$design</code>).</p>
<p>A detailed description of how the synthetic dataset was simulated is
included in one of the package vignettes.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## load the libraries</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">gASCA</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## load the dataset</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"synth_count_data"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## show a compact representation of the structure of the dataset</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">synth_count_data</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## List of 2</span></span>
<span><span class="co">##  $ counts: int [1:150, 1:15] 0 1 4 2 1 2 2 0 1 1 ...</span></span>
<span><span class="co">##   ..- attr(*, "dimnames")=List of 2</span></span>
<span><span class="co">##   .. ..$ : NULL</span></span>
<span><span class="co">##   .. ..$ : chr [1:15] "s1" "s2" "s3" "s4" ...</span></span>
<span><span class="co">##  $ design:'data.frame':  150 obs. of  2 variables:</span></span>
<span><span class="co">##   ..$ time     : chr [1:150] "t0" "t0" "t0" "t0" ...</span></span>
<span><span class="co">##   ..$ treatment: chr [1:150] "B1" "B1" "B1" "B1" ...</span></span></code></pre>
<p>In this synthetic dataset we are dealing with a design with 5 time
points and three treatments</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## time</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">synth_count_data</span><span class="op">$</span><span class="va">design</span><span class="op">$</span><span class="va">time</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "t0" "t1" "t2" "t3" "t4"</span></span></code></pre>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## time</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">synth_count_data</span><span class="op">$</span><span class="va">design</span><span class="op">$</span><span class="va">treatment</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "B1" "B2" "B3"</span></span></code></pre>
<p>The following plot shows the distribution of the counts for variable
<code>s1</code> as a function of the design factors</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind.data.frame</a></span><span class="op">(</span><span class="va">synth_count_data</span><span class="op">$</span><span class="va">design</span>,<span class="va">synth_count_data</span><span class="op">$</span><span class="va">counts</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/stripchart.html" class="external-link">stripchart</a></span><span class="op">(</span><span class="va">s1</span> <span class="op">~</span> <span class="va">time</span>, data <span class="op">=</span> <span class="va">data_df</span><span class="op">[</span><span class="va">data_df</span><span class="op">$</span><span class="va">treatment</span> <span class="op">==</span><span class="st">"B1"</span>,<span class="op">]</span>, vertical <span class="op">=</span> <span class="cn">TRUE</span>, pch <span class="op">=</span> <span class="fl">1</span>, method <span class="op">=</span> <span class="st">"jitter"</span>, </span>
<span>           col <span class="op">=</span> <span class="st">"orange"</span>, main <span class="op">=</span> <span class="st">"S1"</span>, ylab <span class="op">=</span> <span class="st">"Counts"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/stripchart.html" class="external-link">stripchart</a></span><span class="op">(</span><span class="va">s1</span> <span class="op">~</span> <span class="va">time</span>, data <span class="op">=</span> <span class="va">data_df</span><span class="op">[</span><span class="va">data_df</span><span class="op">$</span><span class="va">treatment</span> <span class="op">==</span><span class="st">"B2"</span>,<span class="op">]</span>, vertical <span class="op">=</span> <span class="cn">TRUE</span>, pch <span class="op">=</span> <span class="fl">1</span>, method <span class="op">=</span> <span class="st">"jitter"</span>, col <span class="op">=</span> <span class="st">"steelblue"</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/stripchart.html" class="external-link">stripchart</a></span><span class="op">(</span><span class="va">s1</span> <span class="op">~</span> <span class="va">time</span>, data <span class="op">=</span> <span class="va">data_df</span><span class="op">[</span><span class="va">data_df</span><span class="op">$</span><span class="va">treatment</span> <span class="op">==</span><span class="st">"B3"</span>,<span class="op">]</span>, vertical <span class="op">=</span> <span class="cn">TRUE</span>, pch <span class="op">=</span> <span class="fl">1</span>, method <span class="op">=</span> <span class="st">"jitter"</span>, col <span class="op">=</span> <span class="st">"red"</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topleft"</span>, legend<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Treat B1"</span>, <span class="st">"Treat B2"</span>, <span class="st">"Treat B3"</span><span class="op">)</span>,</span>
<span>       col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"orange"</span>,<span class="st">"steelblue"</span>,<span class="st">"red"</span><span class="op">)</span>, lty <span class="op">=</span> <span class="fl">1</span>, bty <span class="op">=</span> <span class="st">"n"</span><span class="op">)</span></span></code></pre></div>
<p><img src="src/Asca_dec_count_data_files/figure-gfm/unnamed-chunk-4-1.png"><!-- --></p>
<p>The effect of time on this variable is clear.</p>
</div>
<div class="section level2">
<h2 id="performing-the-decomposition">Performing the decomposition<a class="anchor" aria-label="anchor" href="#performing-the-decomposition"></a>
</h2>
<p>The function which performs the gASCA decomposition is
<code>ASCA_decompose</code> and its results are organized in a list. To
run the function it is necessary to provide:</p>
<ul>
<li>a <code>matrix</code> or a <code>data.frame</code> with the
counts;</li>
<li>a <code>data.frame</code> with the association between the samples
and the design. Beware that numeric columns will results in a
decomposition error!</li>
<li>a formula (actually a character vector) which specify the form of
the decomposition;</li>
<li>a <code>list</code> with the parameters which will be passed to the
<code>glm</code> call;</li>
<li>a character vector specifying the type of errors which will be
returned by <code>glm</code>;</li>
</ul>
<p>The synthetic data consists of counts so the natural choice is to run
a Poisson glm. The formula specifies a 3 term decomposition accounting
for the effects of <code>time</code>, <code>treatment</code> and their
interaction. Within <code>ASCA-decompose</code> the formula has to be
specified following the standard <code>glm</code> syntax.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## perform the decomposition</span></span>
<span><span class="va">asca0</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ASCA_decompose.html">ASCA_decompose</a></span><span class="op">(</span></span>
<span>  d <span class="op">=</span> <span class="va">synth_count_data</span><span class="op">$</span><span class="va">design</span>,</span>
<span>  x <span class="op">=</span> <span class="va">synth_count_data</span><span class="op">$</span><span class="va">counts</span>, </span>
<span>  f <span class="op">=</span> <span class="st">"time + treatment + time:treatment"</span>,</span>
<span>  glm_par <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">poisson</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Let’s give a look to the structure of the <code>asca0</code>
object</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">asca0</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## List of 14</span></span>
<span><span class="co">##  $ decomposition:List of 3</span></span>
<span><span class="co">##   ..$ time          : num [1:150, 1:15] -1.49 -1.49 -1.49 -1.49 -1.49 ...</span></span>
<span><span class="co">##   .. ..- attr(*, "dimnames")=List of 2</span></span>
<span><span class="co">##   .. .. ..$ : chr [1:150] "1" "2" "3" "4" ...</span></span>
<span><span class="co">##   .. .. ..$ : chr [1:15] "s1" "s2" "s3" "s4" ...</span></span>
<span><span class="co">##   ..$ treatment     : num [1:150, 1:15] -0.0334 -0.0334 -0.0334 -0.0334 -0.0334 ...</span></span>
<span><span class="co">##   .. ..- attr(*, "dimnames")=List of 2</span></span>
<span><span class="co">##   .. .. ..$ : chr [1:150] "1" "2" "3" "4" ...</span></span>
<span><span class="co">##   .. .. ..$ : chr [1:15] "s1" "s2" "s3" "s4" ...</span></span>
<span><span class="co">##   ..$ time:treatment: num [1:150, 1:15] -0.0759 -0.0759 -0.0759 -0.0759 -0.0759 ...</span></span>
<span><span class="co">##   .. ..- attr(*, "dimnames")=List of 2</span></span>
<span><span class="co">##   .. .. ..$ : chr [1:150] "1" "2" "3" "4" ...</span></span>
<span><span class="co">##   .. .. ..$ : chr [1:15] "s1" "s2" "s3" "s4" ...</span></span>
<span><span class="co">##  $ mu           : Named num [1:15] 1.93 3.02 4.01 5 6 ...</span></span>
<span><span class="co">##   ..- attr(*, "names")= chr [1:15] "s1" "s2" "s3" "s4" ...</span></span>
<span><span class="co">##  $ residuals    : num [1:150, 1:15] -1.4 -0.4 2.6 0.6 -0.4 ...</span></span>
<span><span class="co">##   ..- attr(*, "dimnames")=List of 2</span></span>
<span><span class="co">##   .. ..$ : chr [1:150] "1" "2" "3" "4" ...</span></span>
<span><span class="co">##   .. ..$ : chr [1:15] "s1" "s2" "s3" "s4" ...</span></span>
<span><span class="co">##  $ prediction   : num [1:150, 1:15] 0.336 0.336 0.336 0.336 0.336 ...</span></span>
<span><span class="co">##   ..- attr(*, "dimnames")=List of 2</span></span>
<span><span class="co">##   .. ..$ : chr [1:150] "1" "2" "3" "4" ...</span></span>
<span><span class="co">##   .. ..$ : chr [1:15] "s1" "s2" "s3" "s4" ...</span></span>
<span><span class="co">##  $ pseudoR2     : Named num [1:15] 0.907 0.958 0.964 0.978 0.998 ...</span></span>
<span><span class="co">##   ..- attr(*, "names")= chr [1:15] "s1" "s2" "s3" "s4" ...</span></span>
<span><span class="co">##  $ glm_par      :List of 1</span></span>
<span><span class="co">##   ..$ family:List of 12</span></span>
<span><span class="co">##   .. ..$ family    : chr "poisson"</span></span>
<span><span class="co">##   .. ..$ link      : chr "log"</span></span>
<span><span class="co">##   .. ..$ linkfun   :function (mu)  </span></span>
<span><span class="co">##   .. ..$ linkinv   :function (eta)  </span></span>
<span><span class="co">##   .. ..$ variance  :function (mu)  </span></span>
<span><span class="co">##   .. ..$ dev.resids:function (y, mu, wt)  </span></span>
<span><span class="co">##   .. ..$ aic       :function (y, n, mu, wt, dev)  </span></span>
<span><span class="co">##   .. ..$ mu.eta    :function (eta)  </span></span>
<span><span class="co">##   .. ..$ initialize:  expression({  if (any(y &lt; 0))  stop("negative values not allowed for the 'Poisson' family")  n &lt;- rep.int(1, nobs| __truncated__</span></span>
<span><span class="co">##   .. ..$ validmu   :function (mu)  </span></span>
<span><span class="co">##   .. ..$ valideta  :function (eta)  </span></span>
<span><span class="co">##   .. ..$ simulate  :function (object, nsim)  </span></span>
<span><span class="co">##   .. ..- attr(*, "class")= chr "family"</span></span>
<span><span class="co">##  $ res_type     : chr "response"</span></span>
<span><span class="co">##  $ varimp       : num [1:15, 1:3] 12.841 11.938 7.444 7.187 0.118 ...</span></span>
<span><span class="co">##   ..- attr(*, "dimnames")=List of 2</span></span>
<span><span class="co">##   .. ..$ : chr [1:15] "s1" "s2" "s3" "s4" ...</span></span>
<span><span class="co">##   .. ..$ : chr [1:3] "time" "treatment" "time:treatment"</span></span>
<span><span class="co">##  $ terms_L2     : Named num [1:3] 20.4 18 14.8</span></span>
<span><span class="co">##   ..- attr(*, "names")= chr [1:3] "time" "treatment" "time:treatment"</span></span>
<span><span class="co">##  $ d            :'data.frame':   150 obs. of  2 variables:</span></span>
<span><span class="co">##   ..$ time     : chr [1:150] "t0" "t0" "t0" "t0" ...</span></span>
<span><span class="co">##   ..$ treatment: chr [1:150] "B1" "B1" "B1" "B1" ...</span></span>
<span><span class="co">##  $ x            :'data.frame':   150 obs. of  15 variables:</span></span>
<span><span class="co">##   ..$ s1 : int [1:150] 0 1 4 2 1 2 2 0 1 1 ...</span></span>
<span><span class="co">##   ..$ s2 : int [1:150] 3 2 7 5 8 4 6 7 6 4 ...</span></span>
<span><span class="co">##   ..$ s3 : int [1:150] 19 23 37 38 37 23 31 29 24 29 ...</span></span>
<span><span class="co">##   ..$ s4 : int [1:150] 75 67 89 67 74 68 60 70 74 64 ...</span></span>
<span><span class="co">##   ..$ s5 : int [1:150] 95 99 100 91 94 95 107 103 85 100 ...</span></span>
<span><span class="co">##   ..$ s6 : int [1:150] 86 100 106 86 106 99 117 93 108 112 ...</span></span>
<span><span class="co">##   ..$ s7 : int [1:150] 344 371 330 350 324 332 337 373 340 335 ...</span></span>
<span><span class="co">##   ..$ s8 : int [1:150] 123 121 132 120 125 115 142 155 119 111 ...</span></span>
<span><span class="co">##   ..$ s9 : int [1:150] 25 15 19 19 14 16 12 24 15 20 ...</span></span>
<span><span class="co">##   ..$ s10: int [1:150] 6 7 4 6 8 10 9 4 6 7 ...</span></span>
<span><span class="co">##   ..$ s11: int [1:150] 384 378 411 407 428 394 400 413 416 422 ...</span></span>
<span><span class="co">##   ..$ s12: int [1:150] 141 131 129 166 142 154 146 139 170 134 ...</span></span>
<span><span class="co">##   ..$ s13: int [1:150] 2959 2951 2953 3008 2988 3045 2968 3032 2981 2990 ...</span></span>
<span><span class="co">##   ..$ s14: int [1:150] 121 155 126 167 130 157 155 117 139 141 ...</span></span>
<span><span class="co">##   ..$ s15: int [1:150] 16 19 21 26 19 21 17 20 26 22 ...</span></span>
<span><span class="co">##  $ f            : chr "time + treatment + time:treatment"</span></span>
<span><span class="co">##  $ combined     : NULL</span></span>
<span><span class="co">##  $ linkinv      :function (eta)</span></span></code></pre>
<p>For a detailed description of the elements of the list the reader
could refer to the documentation. The main output of the function is a
list which holds the result of the decomposition
(<code>asca0$decomposition</code>). Each element of this list is a
matrix containing the expected values estimated by the glm model of the
individual variables. Each decomposition matrix holds samples as rows
and variables as columns. Among the other terms of the output we would
like to highlight:</p>
<p><em><code>pseudoR2</code>: a vector holding the pseudo
</em>R<em><sup>2</sup> of the individual univariate models, which can be
used to assess the level of fit of the proposed decomposition on each
individual variable; </em><code>varimp</code>: a matrix holding the
importance of each variable for the different decomposition terms. The
variable importance is defined as the norm of the vector composed by the
estimated expected values. It is important to point out that this type
of variable importance can be biased in presence of log link functions
and for variables showing large fraction of zeroes;
*<code>terms_L2</code>: a vector holding the Frobenius norm of the
decomposition matrices.</p>
<p><span class="math display">\[
\lVert Y \rVert\_{Frobenius} = \sqrt{\sum\_{ij} \lvert y\_{ij} \rvert^2}
\]</span></p>
<p>The L2-norm and the <code>varimp</code> can be used to compare the
importance of the different variables and decomposition terms. Due to
the characteristics of the matrix norm, this measure of importance is
also biased for non gaussian link functions and large fraction of
zeroes.</p>
<p>For a detailed description of the individual elements of the
decomposition list the user can refer to the package documentation.</p>
</div>
<div class="section level2">
<h2 id="validation">Validation<a class="anchor" aria-label="anchor" href="#validation"></a>
</h2>
<p>In terms of matrix algebra, the ASCA decomposition of a matrix
<em>X</em> can be interpreted as a data model</p>
<p><em>Y</em> = <em>Y</em><sub><em>A</em></sub> + <em>Y</em><sub><em>B</em></sub> + <em>Y</em><sub><em>C</em></sub> + … + <em>E</em></p>
<p>The significance of this decomposition can then be assessed by
constructing an empirical null distribution of the norms of each term by
repeatedly (and independently) permuting the design labels. The
rationale behind this idea is to assess how likely is to obtain the
observed norms only by chance. Permutation can be applied both to the
L2-norm of the individual terms and to the estimates of variable
importance. Unfortunately, as already discussed, in the case of count
data, this type of approach may be biased in presence of a large
fraction of zeroes. As a partial alternative, here we propose to use the
same strategy to used assess the responsiveness of the individual
variables to the model in terms of pseudo <em>R</em><sup>2</sup>,
defined as</p>
<p><em>R</em><sub><em>p<strong>s</strong>e<strong>u</strong>d<strong>o<em></em></strong></em></sub><sup>2</sup> = 1 − de<strong>v</strong>i<strong>a</strong>n<strong>c</strong>e_<em>r<strong>e</strong>s<strong>i</strong>d<strong>u</strong>a<strong>l<em>/</em>d</strong>e<strong>v</strong>i<strong>a</strong>n<strong>c</strong>e</em>_*n<strong>u</strong>l**l*</p>
<p>As for the conventional <em>R</em><sup>2</sup>, values closer to 1
indicate a better fit. Conversely, values closer to 0 are obtained if
the residual deviance of the model is comparable with the deviance of
the null model and this is the indication that the proposed model is not
a clear improvement in comparison to the null model.</p>
<p>The idea is to identify which variables are significantly affected by
the design and then to limit the multivariate decomposition to them.</p>
<p>In the <code>gASCA</code> package the permutation based approach is
provided by the <code>ASCA_permutation</code> function, which requires
as input the results of <code>ASCA_decompose</code>, the number of
independent permutations (100 by default) and the empirical quantile
used to judge the significance (0.95 by default).</p>
<p>Let’s now run the validation</p>
<p>The <code>asca0_validation</code> holds the quantiles of the
empirical null distribution obtained by permutation. The following plot
shows the results of the significance test of the L2-norm of the
individual terms.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html" class="external-link">barplot</a></span><span class="op">(</span><span class="va">asca0</span><span class="op">$</span><span class="va">terms_L2</span>, col <span class="op">=</span> <span class="st">"steelblue"</span>, main <span class="op">=</span> <span class="st">"Term L2 norm"</span>, border <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html" class="external-link">barplot</a></span><span class="op">(</span><span class="va">asca0_validation</span><span class="op">$</span><span class="va">L2_qt</span>, col <span class="op">=</span> <span class="st">"#8f1402"</span>, border <span class="op">=</span> <span class="cn">NA</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="src/Asca_dec_count_data_files/figure-gfm/unnamed-chunk-8-1.png"><!-- --></p>
<p>The red rectangle indicate the 95 percentile of the null distribution
of the norm for each term. In this case the decomposition turns out to
be significant for all terms, and all three design factors show a
comparable relevance in the decomposition.</p>
<p>In terms of the variable importance for the three factors,
instead:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html" class="external-link">barplot</a></span><span class="op">(</span><span class="va">asca0</span><span class="op">$</span><span class="va">varimp</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, col <span class="op">=</span> <span class="st">"steelblue"</span>, main <span class="op">=</span> <span class="st">"Variable importance: time"</span>, border <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html" class="external-link">barplot</a></span><span class="op">(</span><span class="va">asca0_validation</span><span class="op">$</span><span class="va">varimp_qt</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, col <span class="op">=</span> <span class="st">"#8f1402"</span>, border <span class="op">=</span> <span class="cn">NA</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html" class="external-link">barplot</a></span><span class="op">(</span><span class="va">asca0</span><span class="op">$</span><span class="va">varimp</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>, col <span class="op">=</span> <span class="st">"steelblue"</span>, main <span class="op">=</span> <span class="st">"Variable importance: treatment"</span>, border <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html" class="external-link">barplot</a></span><span class="op">(</span><span class="va">asca0_validation</span><span class="op">$</span><span class="va">varimp_qt</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>, col <span class="op">=</span> <span class="st">"#8f1402"</span>, border <span class="op">=</span> <span class="cn">NA</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html" class="external-link">barplot</a></span><span class="op">(</span><span class="va">asca0</span><span class="op">$</span><span class="va">varimp</span><span class="op">[</span>,<span class="fl">3</span><span class="op">]</span>, col <span class="op">=</span> <span class="st">"steelblue"</span>, main <span class="op">=</span> <span class="st">"Variable importance: time:treatment"</span>, border <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html" class="external-link">barplot</a></span><span class="op">(</span><span class="va">asca0_validation</span><span class="op">$</span><span class="va">varimp_qt</span><span class="op">[</span>,<span class="fl">3</span><span class="op">]</span>, col <span class="op">=</span> <span class="st">"#8f1402"</span>, border <span class="op">=</span> <span class="cn">NA</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="src/Asca_dec_count_data_files/figure-gfm/unnamed-chunk-9-1.png"><!-- --></p>
<p>As before, the red bars indicate the empirical quantile of the
variable importance upon permutation of the design. The picture we get
with this analysis is in line with the characteristics of the simulated
dataset: only the first four species are significantly responding to the
<em>time</em> factor; s5 and s6, instead are important for
<em>treatment</em> and s7 .. s10 for the <em>interaction</em>.</p>
<p>The following plot shows the result of the model fit assessment in
terms of pseudo <em>R</em><sup>2</sup>:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html" class="external-link">barplot</a></span><span class="op">(</span><span class="va">asca0</span><span class="op">$</span><span class="va">pseudoR2</span>, col <span class="op">=</span> <span class="st">"steelblue"</span>, main <span class="op">=</span> <span class="st">"Univariate model fit"</span>, border <span class="op">=</span> <span class="cn">NA</span>, ylab <span class="op">=</span> <span class="st">"pseudo R2"</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html" class="external-link">barplot</a></span><span class="op">(</span><span class="va">asca0_validation</span><span class="op">$</span><span class="va">R2_qt</span>, col <span class="op">=</span> <span class="st">"#8f1402"</span>, border <span class="op">=</span> <span class="cn">NA</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="src/Asca_dec_count_data_files/figure-gfm/unnamed-chunk-10-1.png"><!-- --></p>
<p>Also here the results are coherent with the design of the synthetic
dataset: the first 10 variables shows a significant
pseudo-<em>R</em><sup>2</sup> and this is not only indicating that they
are significantly responding to the design, but also that the proposed
model is capturing a large fraction of the data variability. It is also
interesting to observe that, not unexpectedly, the univariate null
quantiles are similar for all the 10 variables.</p>
<p>As already discussed, the previous results can be used to restrict
the analysis to the responsive variables. In the <code>gASCA</code>
package the decomposition can be trimmed by using the
<code><a href="../reference/ASCA_trim_vars.html">ASCA_trim_vars()</a></code> function:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">focus_dec</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ASCA_trim_vars.html">ASCA_trim_vars</a></span><span class="op">(</span><span class="va">asca0</span><span class="op">$</span><span class="va">decomposition</span>, keep <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="analysis-of-the-decomposition-terms">Analysis of the decomposition terms<a class="anchor" aria-label="anchor" href="#analysis-of-the-decomposition-terms"></a>
</h2>
<div class="section level3">
<h3 id="eigenvectors-and-multivariate-decomposition">Eigenvectors and Multivariate Decomposition<a class="anchor" aria-label="anchor" href="#eigenvectors-and-multivariate-decomposition"></a>
</h3>
<div class="section level4">
<h4 id="time">Time<a class="anchor" aria-label="anchor" href="#time"></a>
</h4>
<p>Let’s now focus on the three decomposition matrices in terms of their
multivariate latent factors. Depending on the term, these LV can be
interpreted as “eigentrends” (for time) or “eigentreatments” (for
treatment) and they are actually what we would like to interpret.
Remember that the rank of the matrix associated to each factor is
determined by the number of levels of each factor because the
decomposition matrices are constructed with the model expected values.
The number of LVs will be then equal to the number of factors minus
one.</p>
<p>As an example, this is the set of predicted values for the time
factor of variable <code>s1</code></p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">asca0</span><span class="op">$</span><span class="va">decomposition</span><span class="op">$</span><span class="va">time</span><span class="op">[</span>,<span class="st">"s1"</span><span class="op">]</span>, ylab <span class="op">=</span> <span class="st">"I"</span>, xlab <span class="op">=</span> <span class="st">"Sample Index"</span>, pch <span class="op">=</span> <span class="fl">19</span>, col <span class="op">=</span> <span class="st">"steelblue"</span><span class="op">)</span></span></code></pre></div>
<p><img src="src/Asca_dec_count_data_files/figure-gfm/unnamed-chunk-12-1.png"><!-- --></p>
<p>The presence of a limited number of constant values is coherent with
the levels of the time factor, while the scale on the y axis shows that
predictions are performed in the linear predictor space. Since the
<em>time</em> factor has 5 levels the rank of the matrix will be four.
We then expect four eigentrends. Their relative importance is
proportional to the individual eigenvalues.</p>
<p>The SVD decomposition of the ASCA array is performed by the
<code>ASCA_svd</code> function.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">asca0_svd</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ASCA_svd.html">ASCA_svd</a></span><span class="op">(</span><span class="va">focus_dec</span><span class="op">)</span></span></code></pre></div>
<p>Also here the result is a list with each element holding the results
of the svd of the single decomposition terms performed by using the
<code>prcomp</code> function of base R. As in a usual PCA analysis, the
amount of explained variability (square of the standard deviation) can
be used to identify how many eigentrends are needed to present an
informative representation of the overall matrix. This type of
representation is known as <em>scree plot</em>.</p>
<p>Let’s first consider the <em>time</em> factor. The following
screeplot can be used to identify the number of relevant
eigentrends:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">asca0_svd</span><span class="op">$</span><span class="va">time</span>, col <span class="op">=</span> <span class="st">"#4682b490"</span>, main <span class="op">=</span> <span class="st">"Screeplot: time"</span>, npcs <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span></code></pre></div>
<p><img src="src/Asca_dec_count_data_files/figure-gfm/unnamed-chunk-14-1.png"><!-- --></p>
<p>Apparently two LVs are able to capture the global structure of the
data. Let’s visualize the two eigentrends</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## reduce to a set of individual values compensating for potential numeric inaccuracies</span></span>
<span><span class="va">eigentrends</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind.data.frame</a></span><span class="op">(</span>time <span class="op">=</span> <span class="va">synth_count_data</span><span class="op">$</span><span class="va">design</span><span class="op">$</span><span class="va">time</span>,</span>
<span>                                       LV1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">asca0_svd</span><span class="op">$</span><span class="va">time</span><span class="op">$</span><span class="va">x</span><span class="op">[</span>,<span class="st">"PC1"</span><span class="op">]</span>,<span class="fl">2</span><span class="op">)</span>,</span>
<span>                                       LV2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">asca0_svd</span><span class="op">$</span><span class="va">time</span><span class="op">$</span><span class="va">x</span><span class="op">[</span>,<span class="st">"PC2"</span><span class="op">]</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">eigentrends</span></span></code></pre></div>
<pre><code><span><span class="co">##     time   LV1   LV2</span></span>
<span><span class="co">## 1     t0 -2.05  0.99</span></span>
<span><span class="co">## 31    t1 -1.02 -0.52</span></span>
<span><span class="co">## 61    t2  0.03 -1.01</span></span>
<span><span class="co">## 91    t3  1.07 -0.49</span></span>
<span><span class="co">## 121   t4  1.97  1.03</span></span></code></pre>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">LV1</span><span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">LV1</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">eigentrends</span>, </span>
<span>     xaxt <span class="op">=</span> <span class="st">'n'</span>, type <span class="op">=</span> <span class="st">"b"</span>, col <span class="op">=</span> <span class="st">"steelblue"</span>, pch <span class="op">=</span> <span class="fl">19</span>, xlab <span class="op">=</span> <span class="st">"time"</span>, cex <span class="op">=</span> <span class="fl">1</span>, main <span class="op">=</span> <span class="st">"Eigentrend #1"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/axis.html" class="external-link">axis</a></span><span class="op">(</span><span class="fl">1</span>, at<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">eigentrends</span><span class="op">$</span><span class="va">LV1</span><span class="op">)</span>, labels<span class="op">=</span><span class="va">eigentrends</span><span class="op">$</span><span class="va">time</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">LV2</span><span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">LV2</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">eigentrends</span>, </span>
<span>     xaxt <span class="op">=</span> <span class="st">'n'</span>, type <span class="op">=</span> <span class="st">"b"</span>, col <span class="op">=</span> <span class="st">"orange"</span>, pch <span class="op">=</span> <span class="fl">19</span>, xlab <span class="op">=</span> <span class="st">"time"</span>, cex <span class="op">=</span> <span class="fl">1</span>, main <span class="op">=</span> <span class="st">"Eigentrend #2"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/axis.html" class="external-link">axis</a></span><span class="op">(</span><span class="fl">1</span>, at<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">eigentrends</span><span class="op">$</span><span class="va">LV2</span><span class="op">)</span>, labels<span class="op">=</span><span class="va">eigentrends</span><span class="op">$</span><span class="va">time</span><span class="op">)</span></span></code></pre></div>
<p><img src="src/Asca_dec_count_data_files/figure-gfm/unnamed-chunk-16-1.png"><!-- --></p>
<p>As expected, the first eigentrend is characterized by a steady
increase which contrasts with the pattern of the second LV with a “U”
shaped profile. In the synthetic data the actual trend of LV2 for the
time factor is opposite, but this simply results from the sign
indetermination of PCA. The loadings will tell which variables are
mainly associated to them.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html" class="external-link">barplot</a></span><span class="op">(</span><span class="va">asca0_svd</span><span class="op">$</span><span class="va">time</span><span class="op">$</span><span class="va">rotation</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, col <span class="op">=</span> <span class="st">"steelblue"</span>, main <span class="op">=</span> <span class="st">"Loadingsplot: eigentrend #1"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html" class="external-link">barplot</a></span><span class="op">(</span><span class="va">asca0_svd</span><span class="op">$</span><span class="va">time</span><span class="op">$</span><span class="va">rotation</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>, col <span class="op">=</span> <span class="st">"orange"</span>, main <span class="op">=</span> <span class="st">"Loadingsplot: eigentrend #2"</span><span class="op">)</span></span></code></pre></div>
<p><img src="src/Asca_dec_count_data_files/figure-gfm/unnamed-chunk-17-1.png"><!-- -->
In keeping with the characteristics of the synthetic data, s1 and s2 are
contributing strongly to the increasing eigentrend, while s3 and s4
mainly characterize the second LV. Also the intensity of the loadings
correctly reflects the values used in the generation of the synthetic
dataset. Further supporting the coherence of these results, below we
show the real time trends of the measured values for s1 and s3:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/stripchart.html" class="external-link">stripchart</a></span><span class="op">(</span><span class="va">s1</span> <span class="op">~</span> <span class="va">time</span>, data <span class="op">=</span> <span class="va">data_df</span>, vertical <span class="op">=</span> <span class="cn">TRUE</span>, pch <span class="op">=</span> <span class="fl">1</span>, method <span class="op">=</span> <span class="st">"jitter"</span>, </span>
<span>           col <span class="op">=</span> <span class="st">"steelblue"</span>, main <span class="op">=</span> <span class="st">"S1"</span>, ylab <span class="op">=</span> <span class="st">"Counts"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/stripchart.html" class="external-link">stripchart</a></span><span class="op">(</span><span class="va">s3</span> <span class="op">~</span> <span class="va">time</span>, data <span class="op">=</span> <span class="va">data_df</span>, vertical <span class="op">=</span> <span class="cn">TRUE</span>, pch <span class="op">=</span> <span class="fl">1</span>, method <span class="op">=</span> <span class="st">"jitter"</span>, </span>
<span>           col <span class="op">=</span> <span class="st">"orange"</span>, main <span class="op">=</span> <span class="st">"S3"</span>, ylab <span class="op">=</span> <span class="st">"Counts"</span><span class="op">)</span></span></code></pre></div>
<p><img src="src/Asca_dec_count_data_files/figure-gfm/unnamed-chunk-18-1.png"><!-- --></p>
</div>
<div class="section level4">
<h4 id="treatment">Treatment<a class="anchor" aria-label="anchor" href="#treatment"></a>
</h4>
<p>The treatment factor has 3 levels so a maximum of 2 LVs is expected
to be relevant. As before, the screeplot will highlight the individual
contribution of the two eigentreatments</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">asca0_svd</span><span class="op">$</span><span class="va">treatment</span>, col <span class="op">=</span> <span class="st">"#4682b490"</span>, main <span class="op">=</span> <span class="st">"Screeplot: treatment"</span>, npcs <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="src/Asca_dec_count_data_files/figure-gfm/unnamed-chunk-19-1.png"><!-- --></p>
<p>Nonetheless, as expected, only one LV is relevant here. In the
following plot the profile of the eigentreatment and its loadings are
shown:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## reduce to a set of individual values compensating for potential numeric inaccuracies</span></span>
<span><span class="va">eigentreatments</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind.data.frame</a></span><span class="op">(</span>treatment <span class="op">=</span> <span class="va">synth_count_data</span><span class="op">$</span><span class="va">design</span><span class="op">$</span><span class="va">treatment</span>,</span>
<span>                                       LV1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">asca0_svd</span><span class="op">$</span><span class="va">treatment</span><span class="op">$</span><span class="va">x</span><span class="op">[</span>,<span class="st">"PC1"</span><span class="op">]</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">eigentreatments</span></span></code></pre></div>
<pre><code><span><span class="co">##    treatment   LV1</span></span>
<span><span class="co">## 1         B1 -2.00</span></span>
<span><span class="co">## 11        B2  1.49</span></span>
<span><span class="co">## 21        B3  0.50</span></span></code></pre>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html" class="external-link">barplot</a></span><span class="op">(</span><span class="va">LV1</span><span class="op">~</span><span class="va">treatment</span>, data <span class="op">=</span> <span class="va">eigentreatments</span>, col <span class="op">=</span> <span class="st">"steelblue"</span>, main <span class="op">=</span> <span class="st">"Eigentreatment #1"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html" class="external-link">barplot</a></span><span class="op">(</span><span class="va">asca0_svd</span><span class="op">$</span><span class="va">treatment</span><span class="op">$</span><span class="va">rotation</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, col <span class="op">=</span> <span class="st">"steelblue"</span>, main <span class="op">=</span> <span class="st">"Loadingsplot: eigentrend #1"</span><span class="op">)</span></span></code></pre></div>
<p><img src="src/Asca_dec_count_data_files/figure-gfm/unnamed-chunk-21-1.png"><!-- --></p>
<p>As before, this is perfectly in line with the characteristics of the
synthetic dataset.</p>
</div>
<div class="section level4">
<h4 id="interaction">Interaction<a class="anchor" aria-label="anchor" href="#interaction"></a>
</h4>
<p>The last element of the decomposition is the interaction. Here the
number of possible LVs is large, let’s start with the screeplot</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">asca0_svd</span><span class="op">$</span><span class="va">`time:treatment`</span>, col <span class="op">=</span> <span class="st">"#4682b490"</span>, main <span class="op">=</span> <span class="st">"Screeplot: interaction"</span><span class="op">)</span></span></code></pre></div>
<p><img src="src/Asca_dec_count_data_files/figure-gfm/unnamed-chunk-22-1.png"><!-- --></p>
<p>Here, 2 components are able to capture almost all the variance, with
the first eigenvector showing a prominent role. Let’s look to the shape
of the two components:</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## reduce to a set of individual values compensating for potential numeric inaccuracies</span></span>
<span><span class="va">eigentrends_int</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind.data.frame</a></span><span class="op">(</span>time <span class="op">=</span> <span class="va">synth_count_data</span><span class="op">$</span><span class="va">design</span><span class="op">$</span><span class="va">time</span>,</span>
<span>                                           treatment <span class="op">=</span> <span class="va">synth_count_data</span><span class="op">$</span><span class="va">design</span><span class="op">$</span><span class="va">treatment</span>,</span>
<span>                                       LV1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">asca0_svd</span><span class="op">$</span><span class="va">`time:treatment`</span><span class="op">$</span><span class="va">x</span><span class="op">[</span>,<span class="st">"PC1"</span><span class="op">]</span>,<span class="fl">2</span><span class="op">)</span>,</span>
<span>                                       LV2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">asca0_svd</span><span class="op">$</span><span class="va">`time:treatment`</span><span class="op">$</span><span class="va">x</span><span class="op">[</span>,<span class="st">"PC2"</span><span class="op">]</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">eigentrends_int</span></span></code></pre></div>
<pre><code><span><span class="co">##     time treatment   LV1   LV2</span></span>
<span><span class="co">## 1     t0        B1 -1.16  0.21</span></span>
<span><span class="co">## 11    t0        B2 -1.16 -0.28</span></span>
<span><span class="co">## 21    t0        B3  2.32  0.06</span></span>
<span><span class="co">## 31    t1        B1 -0.60 -0.18</span></span>
<span><span class="co">## 41    t1        B2 -0.61  0.34</span></span>
<span><span class="co">## 51    t1        B3  1.21 -0.16</span></span>
<span><span class="co">## 61    t2        B1  0.62  0.16</span></span>
<span><span class="co">## 71    t2        B2  0.58 -0.39</span></span>
<span><span class="co">## 81    t2        B3 -1.20  0.24</span></span>
<span><span class="co">## 91    t3        B1  1.17 -0.16</span></span>
<span><span class="co">## 101   t3        B2  1.21  0.30</span></span>
<span><span class="co">## 111   t3        B3 -2.38 -0.13</span></span>
<span><span class="co">## 121   t4        B1 -0.02 -0.03</span></span>
<span><span class="co">## 131   t4        B2 -0.03  0.04</span></span>
<span><span class="co">## 141   t4        B3  0.05 -0.01</span></span></code></pre>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">eigentrends_int</span><span class="op">[</span><span class="va">eigentrends_int</span><span class="op">$</span><span class="va">treatment</span> <span class="op">==</span> <span class="st">"B1"</span>,<span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">LV1</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">time</span><span class="op">)</span><span class="op">)</span>, </span>
<span>     xaxt <span class="op">=</span> <span class="st">'n'</span>, type <span class="op">=</span> <span class="st">"b"</span>, col <span class="op">=</span> <span class="st">"orange"</span>, pch <span class="op">=</span> <span class="fl">19</span>, xlab <span class="op">=</span> <span class="st">"time"</span>, cex <span class="op">=</span> <span class="fl">1</span>, main <span class="op">=</span> <span class="st">"Eigentrend #1"</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2.5</span>,<span class="fl">2.5</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">eigentrends_int</span><span class="op">[</span><span class="va">eigentrends_int</span><span class="op">$</span><span class="va">treatment</span> <span class="op">==</span> <span class="st">"B2"</span>,<span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">LV1</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">time</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                                                  type <span class="op">=</span> <span class="st">"b"</span>, col <span class="op">=</span> <span class="st">"steelblue"</span>, pch <span class="op">=</span> <span class="fl">19</span>, xlab <span class="op">=</span> <span class="st">"time"</span>, cex <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">eigentrends_int</span><span class="op">[</span><span class="va">eigentrends_int</span><span class="op">$</span><span class="va">treatment</span> <span class="op">==</span> <span class="st">"B3"</span>,<span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">LV1</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">time</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                                                  type <span class="op">=</span> <span class="st">"b"</span>, col <span class="op">=</span> <span class="st">"red"</span>, pch <span class="op">=</span> <span class="fl">19</span>, xlab <span class="op">=</span> <span class="st">"time"</span>, cex <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/axis.html" class="external-link">axis</a></span><span class="op">(</span><span class="fl">1</span>, at<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">eigentrends_int</span><span class="op">$</span><span class="va">time</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, labels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">eigentrends_int</span><span class="op">$</span><span class="va">time</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">eigentrends_int</span><span class="op">[</span><span class="va">eigentrends_int</span><span class="op">$</span><span class="va">treatment</span> <span class="op">==</span> <span class="st">"B1"</span>,<span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">LV2</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">time</span><span class="op">)</span><span class="op">)</span>, </span>
<span>     xaxt <span class="op">=</span> <span class="st">'n'</span>, type <span class="op">=</span> <span class="st">"b"</span>, col <span class="op">=</span> <span class="st">"orange"</span>, pch <span class="op">=</span> <span class="fl">19</span>, xlab <span class="op">=</span> <span class="st">"time"</span>, cex <span class="op">=</span> <span class="fl">1</span>, main <span class="op">=</span> <span class="st">"Eigentrend #2"</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1.5</span>,<span class="fl">1.5</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">eigentrends_int</span><span class="op">[</span><span class="va">eigentrends_int</span><span class="op">$</span><span class="va">treatment</span> <span class="op">==</span> <span class="st">"B2"</span>,<span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">LV2</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">time</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                                                  type <span class="op">=</span> <span class="st">"b"</span>, col <span class="op">=</span> <span class="st">"steelblue"</span>, pch <span class="op">=</span> <span class="fl">19</span>, xlab <span class="op">=</span> <span class="st">"time"</span>, cex <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">eigentrends_int</span><span class="op">[</span><span class="va">eigentrends_int</span><span class="op">$</span><span class="va">treatment</span> <span class="op">==</span> <span class="st">"B3"</span>,<span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">LV2</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">time</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                                                  type <span class="op">=</span> <span class="st">"b"</span>, col <span class="op">=</span> <span class="st">"red"</span>, pch <span class="op">=</span> <span class="fl">19</span>, xlab <span class="op">=</span> <span class="st">"time"</span>, cex <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/axis.html" class="external-link">axis</a></span><span class="op">(</span><span class="fl">1</span>, at<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">eigentrends_int</span><span class="op">$</span><span class="va">time</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, labels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">eigentrends_int</span><span class="op">$</span><span class="va">time</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"bottomright"</span>, legend<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Treat B1"</span>, <span class="st">"Treat B2"</span>, <span class="st">"Treat B3"</span><span class="op">)</span>,</span>
<span>       col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"orange"</span>,<span class="st">"steelblue"</span>,<span class="st">"red"</span><span class="op">)</span>, lty <span class="op">=</span> <span class="fl">1</span>, bty <span class="op">=</span> <span class="st">"n"</span>, cex <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span></span></code></pre></div>
<p>Also in this case, results are in line with the characteristics of
the synthetic data. The larger eigentrend shows a different temporal
trend of B3 in comparison to the other two treatments. LV2, instead,
differentiates B2 from B1 and B3. Interestingly, both the magnitude of
the scores and the variable importance indicate that the first
eigentrend has a larger impact on the structure of the data. In terms of
loadings:</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html" class="external-link">barplot</a></span><span class="op">(</span><span class="va">asca0_svd</span><span class="op">$</span><span class="va">`time:treatment`</span><span class="op">$</span><span class="va">rotation</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, col <span class="op">=</span> <span class="st">"steelblue"</span>, main <span class="op">=</span> <span class="st">"Loadingsplot: eigentrend #1"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html" class="external-link">barplot</a></span><span class="op">(</span><span class="va">asca0_svd</span><span class="op">$</span><span class="va">`time:treatment`</span><span class="op">$</span><span class="va">rotation</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>, col <span class="op">=</span> <span class="st">"orange"</span>, main <span class="op">=</span> <span class="st">"Loadingsplot: eigentrend #2"</span><span class="op">)</span></span></code></pre></div>
<p><img src="src/Asca_dec_count_data_files/figure-gfm/unnamed-chunk-25-1.png"><!-- --></p>
<p>The reconstruction follows the structure of the data, with the
exception being the direction (sign) of the effect, due to the sign
indetermination of PCA.</p>
</div>
</div>
<div class="section level3">
<h3 id="combining-terms">Combining terms<a class="anchor" aria-label="anchor" href="#combining-terms"></a>
</h3>
<p>The function <code>ASCA_combine_terms</code> allows the combination
of different factor matrices. The function accepts as input the output
of <code>ASCA_decomposition</code> and a character vector specifying
which terms should be combined.</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## combine two terms</span></span>
<span><span class="va">asca0_comb</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ASCA_combine_terms.html">ASCA_combine_terms</a></span><span class="op">(</span><span class="va">asca0</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"time"</span>,<span class="st">"time:treatment"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co">## perform the svd of the combined decomposition removing unresponsive variables</span></span>
<span><span class="va">asca0_comb_svd</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ASCA_svd.html">ASCA_svd</a></span><span class="op">(</span><span class="fu"><a href="../reference/ASCA_trim_vars.html">ASCA_trim_vars</a></span><span class="op">(</span><span class="va">asca0_comb</span><span class="op">$</span><span class="va">decomposition</span>, keep <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Let’s now focus on the LVs of the combined terms.</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## here we use the base scree plot</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">asca0_comb_svd</span><span class="op">$</span><span class="va">`time+time:treatment`</span>, main <span class="op">=</span> <span class="st">"time + time:treatment"</span>, col <span class="op">=</span> <span class="st">"steelblue"</span><span class="op">)</span></span></code></pre></div>
<p><img src="src/Asca_dec_count_data_files/figure-gfm/unnamed-chunk-27-1.png"><!-- --></p>
<p>The screeplot shows that the structure of the combined term is well
characterized by three latent variables which are shown in the following
plot:</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## reduce to a set of individual values compensating for potential numeric inaccuracies</span></span>
<span><span class="va">eigencomb</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind.data.frame</a></span><span class="op">(</span><span class="va">synth_count_data</span><span class="op">$</span><span class="va">design</span>,</span>
<span>                                       LV1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">asca0_comb_svd</span><span class="op">$</span><span class="va">`time+time:treatment`</span><span class="op">$</span><span class="va">x</span><span class="op">[</span>,<span class="st">"PC1"</span><span class="op">]</span>,<span class="fl">2</span><span class="op">)</span>,</span>
<span>                                       LV2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">asca0_comb_svd</span><span class="op">$</span><span class="va">`time+time:treatment`</span><span class="op">$</span><span class="va">x</span><span class="op">[</span>,<span class="st">"PC2"</span><span class="op">]</span>,<span class="fl">2</span><span class="op">)</span>,</span>
<span>                                       LV3 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">asca0_comb_svd</span><span class="op">$</span><span class="va">`time+time:treatment`</span><span class="op">$</span><span class="va">x</span><span class="op">[</span>,<span class="st">"PC3"</span><span class="op">]</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">eigencomb</span></span></code></pre></div>
<pre><code><span><span class="co">##     time treatment   LV1   LV2   LV3</span></span>
<span><span class="co">## 1     t0        B1 -2.18 -1.04  0.94</span></span>
<span><span class="co">## 11    t0        B2 -2.21 -1.03  1.02</span></span>
<span><span class="co">## 21    t0        B3 -1.74  2.42  1.01</span></span>
<span><span class="co">## 31    t1        B1 -1.12 -0.47 -0.56</span></span>
<span><span class="co">## 41    t1        B2 -1.04 -0.48 -0.51</span></span>
<span><span class="co">## 51    t1        B3 -0.88  1.33 -0.49</span></span>
<span><span class="co">## 61    t2        B1  0.20  0.63 -0.97</span></span>
<span><span class="co">## 71    t2        B2  0.04  0.60 -1.06</span></span>
<span><span class="co">## 81    t2        B3 -0.16 -1.17 -1.00</span></span>
<span><span class="co">## 91    t3        B1  1.12  1.08 -0.50</span></span>
<span><span class="co">## 101   t3        B2  1.21  1.10 -0.43</span></span>
<span><span class="co">## 111   t3        B3  0.85 -2.47 -0.54</span></span>
<span><span class="co">## 121   t4        B1  1.97 -0.19  1.10</span></span>
<span><span class="co">## 131   t4        B2  2.00 -0.19  0.98</span></span>
<span><span class="co">## 141   t4        B3  1.92 -0.11  1.02</span></span></code></pre>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">eigencomb</span><span class="op">[</span><span class="va">eigencomb</span><span class="op">$</span><span class="va">treatment</span> <span class="op">==</span> <span class="st">"B1"</span>,<span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">LV1</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">time</span><span class="op">)</span><span class="op">)</span>, </span>
<span>     xaxt <span class="op">=</span> <span class="st">'n'</span>, type <span class="op">=</span> <span class="st">"b"</span>, col <span class="op">=</span> <span class="st">"orange"</span>, pch <span class="op">=</span> <span class="fl">19</span>, xlab <span class="op">=</span> <span class="st">"time"</span>, cex <span class="op">=</span> <span class="fl">1</span>, main <span class="op">=</span> <span class="st">"Eigentrend #1"</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">3.5</span>,<span class="fl">2.5</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">eigencomb</span><span class="op">[</span><span class="va">eigencomb</span><span class="op">$</span><span class="va">treatment</span> <span class="op">==</span> <span class="st">"B2"</span>,<span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">LV1</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">time</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                                                  type <span class="op">=</span> <span class="st">"b"</span>, col <span class="op">=</span> <span class="st">"steelblue"</span>, pch <span class="op">=</span> <span class="fl">19</span>, xlab <span class="op">=</span> <span class="st">"time"</span>, cex <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">eigencomb</span><span class="op">[</span><span class="va">eigencomb</span><span class="op">$</span><span class="va">treatment</span> <span class="op">==</span> <span class="st">"B3"</span>,<span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">LV1</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">time</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                                                  type <span class="op">=</span> <span class="st">"b"</span>, col <span class="op">=</span> <span class="st">"red"</span>, pch <span class="op">=</span> <span class="fl">19</span>, xlab <span class="op">=</span> <span class="st">"time"</span>, cex <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/axis.html" class="external-link">axis</a></span><span class="op">(</span><span class="fl">1</span>, at<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">eigencomb</span><span class="op">$</span><span class="va">time</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, labels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">eigencomb</span><span class="op">$</span><span class="va">time</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"bottomright"</span>, legend<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Treat B1"</span>, <span class="st">"Treat B2"</span>, <span class="st">"Treat B3"</span><span class="op">)</span>,</span>
<span>       col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"orange"</span>,<span class="st">"steelblue"</span>,<span class="st">"red"</span><span class="op">)</span>, lty <span class="op">=</span> <span class="fl">1</span>, bty <span class="op">=</span> <span class="st">"n"</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">eigencomb</span><span class="op">[</span><span class="va">eigencomb</span><span class="op">$</span><span class="va">treatment</span> <span class="op">==</span> <span class="st">"B1"</span>,<span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">LV2</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">time</span><span class="op">)</span><span class="op">)</span>, </span>
<span>     xaxt <span class="op">=</span> <span class="st">'n'</span>, type <span class="op">=</span> <span class="st">"b"</span>, col <span class="op">=</span> <span class="st">"orange"</span>, pch <span class="op">=</span> <span class="fl">19</span>, xlab <span class="op">=</span> <span class="st">"time"</span>, cex <span class="op">=</span> <span class="fl">1</span>, main <span class="op">=</span> <span class="st">"Eigentrend #2"</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">3.5</span>,<span class="fl">2.5</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">eigencomb</span><span class="op">[</span><span class="va">eigencomb</span><span class="op">$</span><span class="va">treatment</span> <span class="op">==</span> <span class="st">"B2"</span>,<span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">LV2</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">time</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                                                  type <span class="op">=</span> <span class="st">"b"</span>, col <span class="op">=</span> <span class="st">"steelblue"</span>, pch <span class="op">=</span> <span class="fl">19</span>, xlab <span class="op">=</span> <span class="st">"time"</span>, cex <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">eigencomb</span><span class="op">[</span><span class="va">eigencomb</span><span class="op">$</span><span class="va">treatment</span> <span class="op">==</span> <span class="st">"B3"</span>,<span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">LV2</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">time</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                                                  type <span class="op">=</span> <span class="st">"b"</span>, col <span class="op">=</span> <span class="st">"red"</span>, pch <span class="op">=</span> <span class="fl">19</span>, xlab <span class="op">=</span> <span class="st">"time"</span>, cex <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/axis.html" class="external-link">axis</a></span><span class="op">(</span><span class="fl">1</span>, at<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">eigencomb</span><span class="op">$</span><span class="va">time</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, labels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">eigencomb</span><span class="op">$</span><span class="va">time</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">eigencomb</span><span class="op">[</span><span class="va">eigencomb</span><span class="op">$</span><span class="va">treatment</span> <span class="op">==</span> <span class="st">"B1"</span>,<span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">LV3</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">time</span><span class="op">)</span><span class="op">)</span>, </span>
<span>     xaxt <span class="op">=</span> <span class="st">'n'</span>, type <span class="op">=</span> <span class="st">"b"</span>, col <span class="op">=</span> <span class="st">"orange"</span>, pch <span class="op">=</span> <span class="fl">19</span>, xlab <span class="op">=</span> <span class="st">"time"</span>, cex <span class="op">=</span> <span class="fl">1</span>, main <span class="op">=</span> <span class="st">"Eigentrend #3"</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">3.5</span>,<span class="fl">2.5</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">eigencomb</span><span class="op">[</span><span class="va">eigencomb</span><span class="op">$</span><span class="va">treatment</span> <span class="op">==</span> <span class="st">"B2"</span>,<span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">LV3</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">time</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                                                  type <span class="op">=</span> <span class="st">"b"</span>, col <span class="op">=</span> <span class="st">"steelblue"</span>, pch <span class="op">=</span> <span class="fl">19</span>, xlab <span class="op">=</span> <span class="st">"time"</span>, cex <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">eigencomb</span><span class="op">[</span><span class="va">eigencomb</span><span class="op">$</span><span class="va">treatment</span> <span class="op">==</span> <span class="st">"B3"</span>,<span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">LV3</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">time</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                                                  type <span class="op">=</span> <span class="st">"b"</span>, col <span class="op">=</span> <span class="st">"red"</span>, pch <span class="op">=</span> <span class="fl">19</span>, xlab <span class="op">=</span> <span class="st">"time"</span>, cex <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/axis.html" class="external-link">axis</a></span><span class="op">(</span><span class="fl">1</span>, at<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">eigencomb</span><span class="op">$</span><span class="va">time</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, labels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">eigencomb</span><span class="op">$</span><span class="va">time</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>These are, instead, the plots of the loadings:</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html" class="external-link">barplot</a></span><span class="op">(</span><span class="va">asca0_comb_svd</span><span class="op">$</span><span class="va">`time+time:treatment`</span><span class="op">$</span><span class="va">rotation</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, col <span class="op">=</span> <span class="st">"steelblue"</span>, main <span class="op">=</span> <span class="st">"Loadingsplot: eigentrend #1"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html" class="external-link">barplot</a></span><span class="op">(</span><span class="va">asca0_comb_svd</span><span class="op">$</span><span class="va">`time+time:treatment`</span><span class="op">$</span><span class="va">rotation</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>, col <span class="op">=</span> <span class="st">"steelblue"</span>, main <span class="op">=</span> <span class="st">"Loadingsplot: eigentrend #2"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html" class="external-link">barplot</a></span><span class="op">(</span><span class="va">asca0_comb_svd</span><span class="op">$</span><span class="va">`time+time:treatment`</span><span class="op">$</span><span class="va">rotation</span><span class="op">[</span>,<span class="fl">3</span><span class="op">]</span>, col <span class="op">=</span> <span class="st">"steelblue"</span>, main <span class="op">=</span> <span class="st">"Loadingsplot: eigentrend #3"</span><span class="op">)</span></span></code></pre></div>
<p><img src="src/Asca_dec_count_data_files/figure-gfm/unnamed-chunk-30-1.png"><!-- --></p>
<p>coherently with what was observed for the <em>time</em> factor, the
first LV of the combined decomposition shows a steady increase which is
now modulated by treatment B3 in the interaction term. The inspection of
the loadings supports this interpretation, s1 and s2 are indeed - by
design - the species showing an increase over time. s7 and s8 are also
partially contributing to this trend and their contribution
differentiates B3 from B1 and B2. LV2 turns out to be similar to LV1 of
the interaction term discussed previously. Similarly, s7 and s8 are the
most influential variables, but now a residual contribution of s1 and s2
is also visible, which accounts for the slight overall time trend
visible in the three treatment traces. The last LV is mirroring the
trend visible in the LV2 of the <em>time</em> factor, this is clearly
confirmed from the loadings plot.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Pietro Franceschi.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
