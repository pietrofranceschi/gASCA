<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>ASCA — ASCA • ASCA</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="ASCA — ASCA" />
<meta property="og:description" content="This function performs the full ASCA decomposition and acts as a constructor of the ASCA S3 object" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ASCA</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.7</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/Asca_dec_count_data.html">ASCA Decomposition of Synthetic Count Data</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>ASCA</h1>
    
    <div class="hidden name"><code>ASCA.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function performs the full ASCA decomposition and acts as a constructor of the ASCA S3 object</p>
    </div>

    <pre class="usage"><span class='fu'>ASCA</span><span class='op'>(</span>
  <span class='va'>d</span>,
  <span class='va'>x</span>,
  <span class='va'>f</span>,
  comb <span class='op'>=</span> <span class='cn'>NULL</span>,
  glm_par <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/vector.html'>vector</a></span><span class='op'>(</span>mode <span class='op'>=</span> <span class='st'>"list"</span>, length <span class='op'>=</span> <span class='fl'>0</span><span class='op'>)</span>,
  res_type <span class='op'>=</span> <span class='st'>"pearson"</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>d</th>
      <td><p>a data frame with the experimental design, which associate each sample to the design factors</p></td>
    </tr>
    <tr>
      <th>x</th>
      <td><p>a matrix with the data measured on the different samples</p></td>
    </tr>
    <tr>
      <th>f</th>
      <td><p>a string with the formula which will be used for the <code>glm</code> decomposition</p></td>
    </tr>
    <tr>
      <th>comb</th>
      <td><p>a character vector specifying which terms of the decomposition should be combined</p></td>
    </tr>
    <tr>
      <th>glm_par</th>
      <td><p>a list with the parameters to be passed to the <code>glm</code> call</p></td>
    </tr>
    <tr>
      <th>res_type</th>
      <td><p>the "type" of the residuals (see Details)</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>An object of class <code>asca</code>. Actually a list holding the results:</p><ul>
<li><p>of the <code>glm</code> decomposition</p></li>
<li><p>of the <code>svd</code> of the factor matrices</p></li>
<li><p>of the validation of the object (if present)</p></li>
</ul>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The ASCA decomposition of a data matrix is performed by using Generalized Linear Models to perform
the estimation of the expected values. the use of GLM's allows the extension of the method to non normal data
and unbalanced designs</p>
<p><code>glm</code> function is also used to calculate the matrix of the residuals. For the available choices refer to the <code>residuals.glm</code> help.
"Pearson" residuals are calculated by default.</p>
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>There are specific methods to handle and extract information from the <code>asca</code> object</p><ul>
<li><p><code>print</code></p></li>
<li><p><code>summary</code></p></li>
<li><p><a href='scores.asca.html'>scores.asca</a></p></li>
<li><p><a href='loadings.html'>loadings</a></p></li>
<li><p><a href='varimp.html'>varimp</a></p></li>
<li><p><a href='plot.asca.html'>plot.asca</a></p></li>
<li><p><a href='validate.html'>validate</a></p></li>
</ul>


    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'>## load the data</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='st'>"synth_count_data"</span><span class='op'>)</span>

<span class='co'>## perform the ASCA decomposition</span>
<span class='va'>ASCA_test</span> <span class='op'>&lt;-</span> <span class='fu'>ASCA</span><span class='op'>(</span>
d <span class='op'>=</span> <span class='va'>synth_count_data</span><span class='op'>$</span><span class='va'>design</span>,
x <span class='op'>=</span> <span class='va'>synth_count_data</span><span class='op'>$</span><span class='va'>counts</span>, 
f <span class='op'>=</span> <span class='st'>"time + treatment + time:treatment"</span>,
glm_par <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>family <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/family.html'>poisson</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span>
<span class='op'>)</span>

<span class='co'>## decomposition with a combination of treatment and interaction</span>
<span class='va'>ASCA_test_comb</span> <span class='op'>&lt;-</span> <span class='fu'>ASCA</span><span class='op'>(</span>
d <span class='op'>=</span> <span class='va'>synth_count_data</span><span class='op'>$</span><span class='va'>design</span>,
x <span class='op'>=</span> <span class='va'>synth_count_data</span><span class='op'>$</span><span class='va'>counts</span>, 
f <span class='op'>=</span> <span class='st'>"time + treatment + time:treatment"</span>,
comb <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"treatment"</span>,<span class='st'>"time:treatment"</span><span class='op'>)</span>,
glm_par <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>family <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/family.html'>poisson</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span>
<span class='op'>)</span>

<span class='co'>## Print a summary of the decomposition</span>
<span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='va'>ASCA_test</span><span class='op'>)</span>
</div><div class='output co'>#&gt; ASCA decomposition 
#&gt; 
#&gt; Number of samples  45 
#&gt; Number of variables 10 
#&gt; 
#&gt; Formula:  time + treatment + time:treatment 
#&gt; Terms: time,treatment,time:treatment,error</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>ASCA_test</span><span class='op'>)</span>
</div><div class='output co'>#&gt; ASCA decomposition 
#&gt; 
#&gt; Number of samples  45 
#&gt; Number of variables 10 
#&gt; 
#&gt; Formula:  time + treatment + time:treatment 
#&gt; Terms: time,treatment,time:treatment,error
#&gt; Validation:  FALSE 
#&gt; 
#&gt; glm parameters: 
#&gt; $family
#&gt; 
#&gt; Family: poisson 
#&gt; Link function: log 
#&gt; 
#&gt; </div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Pietro Franceschi.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


